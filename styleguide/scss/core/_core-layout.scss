//-----------------------------------------------------------------------//
// $LAYOUT
// Mixins, functions, and styles for working with units and grids.
//-----------------------------------------------------------------------//


//-----------------------------------------------------------------------//
// MIXINS AND FUNCTIONS
//-----------------------------------------------------------------------//

@mixin sf-grid-init(
    $fraction: one-whole,
    $gutter: false,
    $row-gutter: false
) {

    @include sf-flexbox-grid(
        $upto: tablet-portrait,
        $gridcell-width: one-whole, 
        $gutter: $gutter,
        $row-gutter: if($row-gutter, $gridcell-vertical-gutter, 0)
    );

    @include sf-flexbox-grid(
        $from: tablet-portrait, 
        $gridcell-width: $fraction, 
        $gutter: $gutter, 
        $row-gutter: if($row-gutter, $gridcell-vertical-gutter, 0)
    );

    @include sf-flexbox-grid(
        $from: tablet-landscape, 
        $gridcell-width: $fraction, 
        $gutter: $gutter, 
        $row-gutter: if($row-gutter, $gridcell-vertical-gutter, 0)
    );

    @include sf-flexbox-grid(
        $from: notebook, 
        $gridcell-width: $fraction, 
        $gutter: $gutter, 
        $row-gutter: if($row-gutter, $gridcell-vertical-gutter, 0)
    );

    @include sf-flexbox-grid(
        $from: desktop, 
        $gridcell-width: $fraction, 
        $gutter: $gutter, 
        $row-gutter: if($row-gutter, $gridcell-vertical-gutter, 0)
    );

    @include sf-flexbox-grid(
        $from: elastic, 
        $gridcell-width: $fraction, 
        $gutter: $gutter, 
        $row-gutter: if($row-gutter, $gridcell-vertical-gutter, 0)
    );

    &[sf-reverse] {

        flex-direction: row-reverse;
    }

    &[sf-equal-heights] {

        @include sf-make-equal-heights();
    }

    &[sf-centered] {

        @include sf-make-centered-grid();
    }
}


//-----------------------------------------------------------------------//
// STYLES
//-----------------------------------------------------------------------//

html, body {

    // Needed for mobile
    overflow-x: hidden;
    max-width: 100vw;
}

body {

    // Needed for mobile
    position: relative;

    //------------------------------------//
    //  PRIMARY SITE WRAPPER
    //------------------------------------//
    header, main, footer {

        @if (map-get($media-breakpoints, elastic) != false) {

            max-width: $elastic-breakpoint;
        }

        margin-left: auto;
        margin-right: auto;
    }
}


/* GRID DEFAULTS

<div role="grid" sf-columns="2" sf-gutters sf-equal-heights sf-centered sf-reverse>
    <div role="gridcell">...</div>
    <div role="gridcell">...</div>
    ...
</div>
*/

[role="grid"] {

    &:not([sf-columns]) {

        &:not([sf-gutters]) {
        
            @include sf-flexbox-grid();
        }

        &[sf-gutters] {
        
            @include sf-flexbox-grid(
                $row-gutter: $gridcell-vertical-gutter
            );
        }

        &[sf-reverse] {

            flex-direction: row-reverse;
        }
    
        &[sf-equal-heights] {

            @include sf-make-equal-heights();
        }
    
        &[sf-centered] {
    
            @include sf-make-centered-grid();
        }
    }

    $counter: 1;

    @each $width in $grid-increments {

        &[sf-columns="#{$counter}"]:not([sf-gutters]) {

            // #{$counter}
            @include sf-grid-init(
                $fraction: #{$width}
            );
        }

        $counter: $counter + 1;
    }

    $counter: 1;

    @each $width in $grid-increments {

        &[sf-columns="#{$counter}"][sf-gutters] {

            @include sf-grid-init(
                $fraction: #{$width},
                $gutter: map-get($grid-gutters, $width),
                $row-gutter: true
            );
        }

        $counter: $counter + 1;
    }
}


/* UNIT STYLING
These are the outer block containers that you stack to create your UX.

<main>
    <section id="hero-unit" sf-unit>
        <div sf-outer-wrapper>
            <div sf-inner-wrapper>
                ...
                <div sf-subunit>
                    ...
                </div>
                ...
            </div>
        </div>
    </div>
    <section id="feature-unit" sf-unit>
        <div sf-outer-wrapper>
            <div sf-inner-wrapper>
                ...
            </div>
        </div>
    </div>
    ...
*/

main {

    & > [sf-unit] {

        &:not(:last-of-type) {

            @include set-bottom-unit-padding();
        }

        &, &:last-of-type {

            @include set-bottom-unit-padding();
        }

        & > div[sf-outer-wrapper] {

            margin-left: auto;
            margin-right: auto;

            @if (map-get($media-breakpoints, elastic) != false) {

                max-width: $elastic-breakpoint;
            }

            @include set-horizontal-unit-padding();

            & > div[sf-inner-wrapper] {

                @include set-top-unit-padding();

                & > * {

                    &:first-child {

                        margin-top: 0;
                    }
                }
            }
        }
    }

    [sf-subunit] {

        @include set-bottom-subunit-margin();

        &:last-child {

            margin-bottom: 0;
        }
    }
}
